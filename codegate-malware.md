
### Run shellcode from malicious doc on windows using visual studio and debug it through x64dbg 

steps:

1- extract malicious VBA from docm using olevba tool 

![image](https://user-images.githubusercontent.com/8508996/155886873-025c9f21-7519-4fff-973e-03a0a1b5c706.png)

2- convert decimal numbers to hex using the python one-liner script

![image](https://user-images.githubusercontent.com/8508996/155893797-b0f898e2-6c12-4f44-ba5a-313a55174802.png)

```
myhex = "909090909090909090"

print("".join([r'\x'+myhex[i:i+2] for i in range(len(myhex)) if i%2==0]))
```

3- write a program to execute your shellcode and open it with x64dbg

![image](https://user-images.githubusercontent.com/8508996/155893406-aeed4c81-263a-4f27-aff3-a94939faefb2.png)

break on *virtualalloc* using the symbols tab as shown below, 

![image](https://user-images.githubusercontent.com/8508996/155893542-9eec82f0-811d-417f-8f1e-1115bc1219be.png)

press F9 till you reach to the breakpoint 

then you will be inside the virtualalloc function, hit CTRL+F9 and hit F8 to step over the call to virtualalloc, you will see the eax register contain an address, this address will have the space for the shellcode, add a hardware breakpoint on execute as shown below:

![image](https://user-images.githubusercontent.com/8508996/155893673-963c70fe-aef3-4889-9acb-fce42f68fba8.png)

![image](https://user-images.githubusercontent.com/8508996/155893694-1c3f9fd9-889d-4844-8aec-7a81dfec61aa.png)


press F9 and you will jump to the shellcode ;) 

![image](https://user-images.githubusercontent.com/8508996/155893777-bb15c7cc-f0a9-4d71-8a76-163ec89fef01.png)

